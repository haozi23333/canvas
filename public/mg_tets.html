<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>canvas 2</title>
    <style>
   body{
     overflow: hidden;
     margin:0px;padding:0px;
 }
 </style>
</head>
<body onkeydown="key_down(this)">
<canvas id="canvas" style="margin:0px;padding:0px"></canvas>
</body>
</html>

<script>
    var b_height=b_width=50;
    var canvas= document.getElementById('canvas');
    var context=canvas.getContext('2d');
    var x=y=50,d=1;//0s1x2z3y
    var speed=10;
    canvas.height=window.innerHeight;
    canvas.width=window.innerWidth;
    var zidan=[];

    function addblock(x,y,color,cxt) {
         cxt.beginPath();
         cxt.fillStyle=color;
         cxt.fillRect(x,y,b_width,b_height);
     }
     function addround(x,y,R,color,cxt) {

          if (color!='white') {
            cxt.beginPath();
            cxt.fillStyle=color;
            cxt.arc(x,y,R,0,2*Math.PI);
            cxt.fill();
          }
      }
    function key_down(e)
 {
    var _c=window.event.keyCode;
     switch (_c)
     {
         case 37://left
         if ((x-speed)>0) {
              x-=speed;
         }
         d=2;
             break;
         case 38://上up
         if ((y-speed)>0) {
               y-=speed;
         }
         d=0;
             break;
         case 39://右right
         if ((x+speed)<(canvas.width-b_height)) {
               x+=speed;
         }
         d=3;
             break;
         case 40://下down
         if ((y+speed)<(canvas.height-b_width)) {
                      y+=speed;
         }
         d=1;
             break;
              case 32://space
          fashe();
                  break;
     }
}
window.onload=function ()
{
  addblock(x,y,'blue',context);
  setInterval(function(){
    update(context);
  },34)

}

function update(cxt)
{
cxt.clearRect(0,0,canvas.height,canvas.width);
  addblock(x,y,'blue',context);
for (var i = 0; i < zidan.length; i++) {
    switch (zidan[i].fx) {
      case 0:
      if (zidan[i].y<0) {
          zidan[i].y-=zidan[i].speed;
      zidan[i].speed=0;
        zidan[i].color='white';
      }
      zidan[i].y-=zidan[i].speed;
      break;
      case 1:
      if (zidan[i].y>canvas.height) {
        zidan[i].y+=zidan[i].speed;
        zidan[i].speed=0;
          zidan[i].color='white';
      }
     zidan[i].y+=zidan[i].speed;
      break;
      case 2:
      if (zidan[i].x<0) {
          zidan[i].x-=zidan[i].speed;
        zidan[i].speed=0;
        zidan[i].color='white';
      }
     zidan[i].x-=zidan[i].speed;
      break;
      case 3:
      if (zidan[i].x>canvas.width) {
          zidan[i].x+=zidan[i].speed;
          zidan[i].speed=0;
          zidan[i].color='white';
      }
      zidan[i].x+=zidan[i].speed;
      break;
    }
    addround(zidan[i].x,zidan[i].y,zidan[i].r,'red',context);
}

}

function fashe()
{
  var zd={
    x:x,
    y:y,
    fx:d,
    speed:5,
    color:'red',
    type:'pt',
    height:20,
    width:20,
    r:10,
    mun:zidan.length
  }
  switch (d) {
    case 0:
    zd.x+=b_width/2;
    zd.y-=10;
    break;
    case 1:
    zd.x+=b_width/2;
    zd.y+=b_height+10;
    break;
    case 2:
    zd.y+=b_height/2;
    zd.x-=10;
    break;
    case 3:
    zd.y+=b_height/2;
    zd.x+=b_height+10;
    break;
  }
zidan.push(zd);
}
function addmonster()
{



}


function sj()
{

}
</script>
